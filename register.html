<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Регистрация - CourseGen</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#a3ff00",
                        "cobblestone-blue": "#2C3E50",
                        "icy-blue": "#AED9E0",
                        "graphite-gray": "#7F8C8D",
                    },
                    fontFamily: {
                        "display": ["Space Grotesk", "sans-serif"]
                    },
                    borderRadius: {"DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px"},
                },
            },
        }
    </script>
</head>
<body class="bg-white font-display text-cobblestone-blue">
    <div class="flex min-h-screen w-full flex-col">
        <!-- TopNavBar -->
        <header class="sticky top-0 z-10 w-full border-b border-graphite-gray/20 bg-white/80 backdrop-blur-md">
            <div class="mx-auto flex max-w-7xl items-center justify-between whitespace-nowrap px-4 py-3 sm:px-6 lg:px-8">
                <div class="flex items-center gap-4">
                    <div class="h-6 w-6 text-cobblestone-blue">
                        <svg fill="currentColor" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                            <path d="M42.4379 44C42.4379 44 36.0744 33.9038 41.1692 24C46.8624 12.9336 42.2078 4 42.2078 4L7.01134 4C7.01134 4 11.6577 12.932 5.96912 23.9969C0.876273 33.9029 7.27094 44 7.27094 44L42.4379 44Z"></path>
                        </svg>
                    </div>
                    <h2 class="text-xl font-bold leading-tight tracking-tight text-cobblestone-blue">CourseGen</h2>
                </div>
                <nav class="hidden items-center gap-8 md:flex">
                    <a class="text-sm font-medium text-cobblestone-blue transition-colors hover:text-primary" href="index.html">Главная</a>
                    <a class="text-sm font-medium text-cobblestone-blue transition-colors hover:text-primary" href="my-courses.html">Мои курсы</a>
                    <a class="text-sm font-medium text-cobblestone-blue transition-colors hover:text-primary" href="generator.html">Генератор</a>
                    <a class="text-sm font-medium text-cobblestone-blue transition-colors hover:text-primary" href="support.html">Поддержка</a>
                </nav>
                <div class="flex items-center gap-2">
                    <a href="register.html" class="flex h-10 min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg bg-primary px-4 text-sm font-bold leading-normal tracking-wide text-cobblestone-blue transition-transform hover:scale-105">
                        <span class="truncate">Регистрация</span>
                    </a>
                    <a href="login.html" class="flex h-10 min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg bg-gray-100 px-4 text-sm font-bold leading-normal tracking-wide text-cobblestone-blue transition-transform hover:scale-105">
                        <span class="truncate">Вход</span>
                    </a>
                </div>
            </div>
        </header>

        <main class="flex-1 bg-white">
            <div class="flex min-h-[calc(100vh-80px)] items-center justify-center px-4 py-8 sm:px-6 lg:px-8">
                <div class="w-full max-w-md">
                    <!-- Register Card -->
                    <div class="rounded-2xl border border-graphite-gray/20 bg-white p-8 shadow-sm">
                        <div class="text-center mb-8">
                            <h1 class="text-2xl font-bold leading-tight tracking-tight text-cobblestone-blue">Создать аккаунт</h1>
                            <p class="mt-2 text-graphite-gray">Заполните форму для регистрации</p>
                        </div>

                        <form id="regForm" class="space-y-6">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="mb-2 block text-sm font-medium text-cobblestone-blue">Имя</label>
                                    <div class="relative">
                                        <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                            <span class="material-symbols-outlined text-graphite-gray">person</span>
                                        </div>
                                        <input id="username" class="w-full rounded-lg border border-graphite-gray/20 bg-white py-3 pl-10 pr-4 text-cobblestone-blue placeholder:text-graphite-gray focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="Имя" type="text" required/>
                                    </div>
                                </div>
                                <div>
                                    <label class="mb-2 block text-sm font-medium text-cobblestone-blue">Фамилия</label>
                                    <div class="relative">
                                        <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                            <span class="material-symbols-outlined text-graphite-gray">person</span>
                                        </div>
                                        <input id="surname" class="w-full rounded-lg border border-graphite-gray/20 bg-white py-3 pl-10 pr-4 text-cobblestone-blue placeholder:text-graphite-gray focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="Фамилия" type="text"/>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label class="mb-2 block text-sm font-medium text-cobblestone-blue">Email адрес</label>
                                <div class="relative">
                                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                        <span class="material-symbols-outlined text-graphite-gray">mail</span>
                                    </div>
                                    <input id="email" class="w-full rounded-lg border border-graphite-gray/20 bg-white py-3 pl-10 pr-4 text-cobblestone-blue placeholder:text-graphite-gray focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="your@email.com" type="email" required/>
                                </div>
                            </div>

                            <div>
                                <label class="mb-2 block text-sm font-medium text-cobblestone-blue">Пароль</label>
                                <div class="relative">
                                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                        <span class="material-symbols-outlined text-graphite-gray">lock</span>
                                    </div>
                                    <input id="password" class="w-full rounded-lg border border-graphite-gray/20 bg-white py-3 pl-10 pr-10 text-cobblestone-blue placeholder:text-graphite-gray focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="Минимум 8 символов" type="password" required/>
                                    <button type="button" class="absolute inset-y-0 right-0 flex items-center pr-3" onclick="togglePassword('password')">
                                        <span class="material-symbols-outlined text-graphite-gray hover:text-cobblestone-blue">visibility</span>
                                    </button>
                                </div>
                                <p class="mt-1 text-xs text-graphite-gray">Пароль должен содержать минимум 8 символов</p>
                            </div>

                            <div>
                                <label class="mb-2 block text-sm font-medium text-cobblestone-blue">Подтвердите пароль</label>
                                <div class="relative">
                                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                        <span class="material-symbols-outlined text-graphite-gray">lock</span>
                                    </div>
                                    <input id="confirm_password" class="w-full rounded-lg border border-graphite-gray/20 bg-white py-3 pl-10 pr-10 text-cobblestone-blue placeholder:text-graphite-gray focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="Повторите пароль" type="password" required/>
                                    <button type="button" class="absolute inset-y-0 right-0 flex items-center pr-3" onclick="togglePassword('confirm_password')">
                                        <span class="material-symbols-outlined text-graphite-gray hover:text-cobblestone-blue">visibility</span>
                                    </button>
                                </div>
                            </div>

                            <div class="flex items-center">
                                <input class="h-4 w-4 rounded border-graphite-gray/20 text-primary focus:ring-primary/50" id="terms" name="terms" type="checkbox" required/>
                                <label class="ml-2 block text-sm text-graphite-gray" for="terms">
                                    Я соглашаюсь с
                                    <a href="#" class="font-medium text-primary hover:text-primary/80">условиями использования</a>
                                    и
                                    <a href="#" class="font-medium text-primary hover:text-primary/80">политикой конфиденциальности</a>
                                </label>
                            </div>

                            <button class="flex w-full cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-xl bg-primary py-4 text-base font-bold leading-normal tracking-wide text-cobblestone-blue transition-transform hover:scale-105" type="submit">
                                <span class="material-symbols-outlined">person_add</span>
                                Создать аккаунт
                            </button>
                        </form>

                        <div class="mt-6 text-center">
                            <p class="text-graphite-gray">
                                Уже есть аккаунт?
                                <a href="login.html" class="font-medium text-primary hover:text-primary/80">Войдите</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <!-- Дополнение: JS для регистрации пользователя -->
    <script>
    function togglePassword(id) {
        const input = document.getElementById(id);
        if (input.type === "password") {
            input.type = "text";
        } else {
            input.type = "password";
        }
    }

    document.getElementById('regForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const username = document.getElementById("username").value.trim();
        // Surname - не используется сервером, можете расширить если надо
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value;
        const confirm_password = document.getElementById("confirm_password").value;

        if(password.length < 8) {
            alert("Пароль должен содержать минимум 8 символов");
            return;
        }
        if(password !== confirm_password) {
            alert("Пароли не совпадают");
            return;
        }

        const response = await fetch("/api/register", {
            method: "POST",
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({username, email, password})
        });
        const result = await response.json();
        if(result.message){
            alert(result.message);
            window.location.href = "login.html";
        } else {
            alert(result.error);
        }
    });
    </script>
</body>
</html>
